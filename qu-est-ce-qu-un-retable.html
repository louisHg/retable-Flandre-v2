<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Qu'est-ce qu'un retable ? - RETABLES de FLANDRE</title>
    <link rel="icon" type="image/jpg" href="images/previous-image/logo.jpg">

    <!-- CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap"
          rel="stylesheet">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-icons.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/sidebar.css" rel="stylesheet">
    <link href="css/components/cards.css" rel="stylesheet">
    <link href="css/components/badges.css" rel="stylesheet">
    <link href="css/components/notifications.css" rel="stylesheet">
</head>

<body>

<main>

    <!-- üì¶ SIDEBAR & TOGGLE charg√©s dynamiquement par sidebar-loader.js -->

    <!-- WRAPPER CONTENU -->
    <div id="rfContent" class="rf-content">

        <!-- üì¶ SECTION 1 : HERO (charg√©e dynamiquement) -->
        <div data-load-component="sections/hero-retable"></div>

        <!-- üì¶ SECTION 2 : TEXTE COLLECTIF (charg√©e dynamiquement) -->
        <div data-load-component="sections/texte-collectif"></div>

        <!-- üì¶ SECTION 3 : ARTICLES SCIENTIFIQUES (charg√©s dynamiquement) -->
        <section class="section-padding" style="padding-top: 80px; padding-bottom: 80px;">
            <div class="container">
                <div class="row align-items-end mb-4">
                    <div class="col-lg-8">
                        <h2 class="mb-2">Publications scientifiques</h2>
                        <p class="mb-0" style="color: #717275;">Articles de recherche sur les retables de Flandre</p>
                    </div>
                </div>

                <!-- üì¶ Conteneur pour les composants articles -->
                <div class="row g-4" id="articlesContainer">
                    <!-- Les composants articles seront charg√©s ici via JavaScript -->
                </div>

            </div>
        </section>

        <!-- üì¶ SECTION 4 : CTA NEWSLETTER (charg√©e dynamiquement) -->
        <div data-load-component="sections/newsletter-cta"></div>

        <!-- üì¶ SECTION 5 : CONTACT (charg√©e dynamiquement) -->
        <div data-load-component="sections/contact"></div>

        <!-- üì¶ FOOTER (charg√© dynamiquement) -->
        <div id="footerContainer"></div>

    </div><!-- /#rfContent -->

</main>

<!-- MODALE IMAGE SCH√âMA -->
<div class="image-modal" id="schemaModal" aria-hidden="true">
    <button class="image-modal-close" type="button" aria-label="Fermer">‚úï</button>

    <div class="image-modal-content" role="dialog" aria-modal="true">
        <div class="image-modal-header">
            <h3 class="image-modal-title">Sch√©ma d'un retable</h3>
        </div>

        <div class="image-modal-body">
            <img id="schemaModalImg" class="image-modal-img" src="images/previous-image/schemadunretable.jpg"
                 alt="Sch√©ma d'un retable">
        </div>
    </div>
</div>

<!-- JAVASCRIPT FILES -->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/jquery.sticky.js"></script>
<script src="js/click-scroll.js"></script>
<script src="js/custom.js"></script>
<script src="js/components-bundle.js"></script>
<script src="js/sidebar-loader.js"></script> <!-- ‚úÖ Charge sidebar + toggle -->
<script src="js/sidebar.js"></script> <!-- ‚úÖ Initialise la logique sidebar -->
<script src="js/component-loader.js"></script>

<script>
    // ==========================================
    // üéØ CONFIGURATION ET INITIALISATION
    // ==========================================

    console.log('üöÄ Initialisation de la page...');

    document.addEventListener("DOMContentLoaded", function () {
        console.log('‚úÖ DOM Charg√©');

        // ==========================================
        // üì¶ CHARGEMENT DES COMPOSANTS
        // ==========================================
        setTimeout(function() {
            loadAllComponents();
        }, 100);

        // ==========================================
        // üñºÔ∏è MODALE SCH√âMA (apr√®s chargement)
        // ==========================================
        setTimeout(function() {
            initSchemaModal();
        }, 800);
    });


    // ==========================================
    // FONCTION : Chargement de tous les composants
    // ==========================================
    async function loadAllComponents() {
        console.log('üì¶ Chargement des composants...');

        try {
            // V√©rifier si le bundle existe
            if (!window.COMPONENTS_BUNDLE) {
                console.error('‚ùå Bundle de composants non trouv√©');
                return;
            }

            console.log('‚úÖ Bundle trouv√© avec', Object.keys(window.COMPONENTS_BUNDLE).length, 'composants');

            // Charger les articles scientifiques en grille
            if (window.loadComponentsGrid) {
                await loadComponentsGrid('#articlesContainer', [
                    { path: 'articles/article-hertel', colClass: 'col-lg-6 col-12 mb-4' },
                    { path: 'articles/article-oger', colClass: 'col-lg-6 col-12 mb-4' }
                ]);
                console.log('‚úÖ Articles scientifiques charg√©s');
            }

            // Charger le footer
            if (window.loadComponent) {
                await loadComponent('#footerContainer', 'sections/footer');
                console.log('‚úÖ Footer charg√©');
            }

        } catch (error) {
            console.error('‚ùå Erreur lors du chargement des composants:', error);
        }
    }

    // ==========================================
    // FONCTION : Initialisation de la modale sch√©ma
    // ==========================================
    function initSchemaModal() {
        const schemaImg = document.getElementById("schemaImg");
        const modal = document.getElementById("schemaModal");
        const closeBtn = modal ? modal.querySelector(".image-modal-close") : null;

        if (!schemaImg || !modal || !closeBtn) {
            console.warn('‚ö†Ô∏è Modale sch√©ma : √©l√©ments non trouv√©s');
            return;
        }

        console.log('üñºÔ∏è Initialisation de la modale sch√©ma...');

        // Ouvrir la modale
        schemaImg.addEventListener("click", function() {
            modal.classList.add("is-open");
            modal.setAttribute("aria-hidden", "false");
            document.body.style.overflow = "hidden";
            console.log('üñºÔ∏è Modale ouverte');
        });

        // Fermer avec le bouton
        closeBtn.addEventListener("click", function() {
            modal.classList.remove("is-open");
            modal.setAttribute("aria-hidden", "true");
            document.body.style.overflow = "";
        });

        // Fermer en cliquant sur le fond
        modal.addEventListener("click", function(e) {
            if (e.target === modal) {
                modal.classList.remove("is-open");
                modal.setAttribute("aria-hidden", "true");
                document.body.style.overflow = "";
            }
        });

        // Fermer avec √âchap
        document.addEventListener("keydown", function(e) {
            if (e.key === "Escape" && modal.classList.contains("is-open")) {
                modal.classList.remove("is-open");
                modal.setAttribute("aria-hidden", "true");
                document.body.style.overflow = "";
            }
        });

        console.log('‚úÖ Modale sch√©ma initialis√©e');
    }
</script>

</body>
</html>

