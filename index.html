<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>RETABLES de FLANDRE - Accueil</title>
    <link rel="icon" type="image/jpg" href="images/previous-image/logo.jpg">

    <!-- CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap"
          rel="stylesheet">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-icons.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/sidebar.css" rel="stylesheet">
    <link href="css/components/cards.css" rel="stylesheet">
    <link href="css/components/badges.css" rel="stylesheet">
    <link href="css/components/notifications.css" rel="stylesheet">
</head>

<body>

<main>

    <!-- ðŸ“¦ SIDEBAR & TOGGLE chargÃ©s dynamiquement par sidebar-loader.js -->

    <!-- WRAPPER CONTENU -->
    <div id="rfContent" class="rf-content">

        <!-- ðŸ“¦ SECTION 1 : HERO HOME (chargÃ©e dynamiquement) -->
        <div data-load-component="sections/hero-home"></div>

        <!-- ðŸ“¦ SECTION 2 : GALERIE CARROUSEL (chargÃ©e dynamiquement) -->
        <div data-load-component="sections/gallery-carousel"></div>

        <!-- ðŸ“¦ SECTION 3 : CTA NEWSLETTER (chargÃ©e dynamiquement) -->
        <div data-load-component="sections/newsletter-cta"></div>

        <!-- ðŸ“¦ SECTION 4 : CONTACT (chargÃ©e dynamiquement) -->
        <div data-load-component="sections/contact"></div>

        <!-- ðŸ“¦ FOOTER (chargÃ© dynamiquement) -->
        <div id="footerContainer"></div>

    </div><!-- /#rfContent -->

</main>

<!-- JAVASCRIPT FILES -->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/jquery.sticky.js"></script>
<script src="js/click-scroll.js"></script>
<script src="js/custom.js"></script>
<script src="js/components-bundle.js"></script>
<script src="js/sidebar-loader.js"></script> <!-- âœ… Charge sidebar + toggle -->
<script src="js/sidebar.js"></script> <!-- âœ… Initialise la logique sidebar -->
<script src="js/component-loader.js"></script>
<script src="js/carousel.js"></script>
<script src="js/image-modal.js"></script>

<!-- EmailJS (pour le formulaire de contact) -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<script>
    // ==========================================
    // ðŸŽ¯ INITIALISATION DE LA PAGE
    // ==========================================

    console.log('ðŸš€ Initialisation de la page d\'accueil...');

    document.addEventListener("DOMContentLoaded", function () {
        console.log('âœ… DOM ChargÃ©');

        // ==========================================
        // ðŸ“¦ CHARGEMENT DES COMPOSANTS
        // ==========================================
        setTimeout(function() {
            loadAllComponents();
        }, 100);

        // ==========================================
        // ðŸ“§ INITIALISATION EMAILJS
        // ==========================================
        setTimeout(function() {
            initEmailJS();
        }, 1000);
    });

    // ==========================================
    // FONCTION : Chargement de tous les composants
    // ==========================================
    async function loadAllComponents() {
        console.log('ðŸ“¦ Chargement des composants...');

        try {
            if (!window.COMPONENTS_BUNDLE) {
                console.error('âŒ Bundle de composants non trouvÃ©');
                return;
            }

            console.log('âœ… Bundle trouvÃ© avec', Object.keys(window.COMPONENTS_BUNDLE).length, 'composants');

            // Charger le footer
            if (window.loadComponent) {
                await loadComponent('#footerContainer', 'sections/footer');
                console.log('âœ… Footer chargÃ©');
            }

        } catch (error) {
            console.error('âŒ Erreur lors du chargement des composants:', error);
        }
    }

    // ==========================================
    // FONCTION : Initialisation EmailJS
    // ==========================================
    function initEmailJS() {
        const form = document.getElementById("contact-form");

        if (!form) {
            console.warn('âš ï¸ Formulaire de contact non trouvÃ©');
            return;
        }

        console.log('ðŸ“§ Initialisation EmailJS...');

        emailjs.init("aDQZj6KUMz6fZ2Qs3");

        form.addEventListener("submit", function (event) {
            event.preventDefault();

            const submitBtn = document.getElementById("submit-btn");
            submitBtn.disabled = true;
            submitBtn.innerText = "Envoi en cours...";

            const formData = {
                fullName: document.getElementById("full-name").value,
                phone: document.getElementById("phone").value,
                email: document.getElementById("email").value,
                message: document.getElementById("message").value
            };

            emailjs.send("service_outp9kh", "template_dkbwnu2", formData)
                .then(function () {
                    alert("Message envoyÃ© avec succÃ¨s !");
                    form.reset();
                })
                .catch(function (error) {
                    alert("Erreur lors de l'envoi. Veuillez rÃ©essayer.");
                    console.error("Erreur EmailJS :", error);
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerText = "Envoyer";
                });
        });

        console.log('âœ… EmailJS initialisÃ©');
    }
</script>

</body>

</html>

