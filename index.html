<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>RETABLES de FLANDRE - Accueil</title>
    <link rel="icon" type="image/jpg" href="images/previous-image/logo.jpg">

    <!-- CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap"
          rel="stylesheet">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-icons.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/sidebar.css" rel="stylesheet">
    <link href="css/components/cards.css" rel="stylesheet">
    <link href="css/components/badges.css" rel="stylesheet">
    <link href="css/components/notifications.css" rel="stylesheet">
</head>

<body>

<main>

    <!-- SIDEBAR -->
    <aside id="rfSidebar" class="rf-sidebar">

        <a class="rf-brand d-flex align-items-center" href="index.html">
            <img src="images/previous-image/logo.jpg" class="rf-brand-image img-fluid" alt="Retables de Flandre">
            <span class="rf-brand-text">
                Retables
                <small>de Flandre</small>
            </span>
        </a>

        <nav class="rf-sidebar-nav">
            <a class="nav-link active" href="index.html">Accueil</a>
            <a class="nav-link" href="generic.html">Association</a>
            <a class="nav-link" href="activites.html">Activit√©s</a>
            <a class="nav-link" href="qu-est-ce-qu-un-retable.html">Qu'est-ce qu'un retable ?</a>
            <a class="nav-link" href="visiteDesEglises.html">Visites des √©glises</a>
            <a class="nav-link" href="depliants-eglises.html">D√©pliants des √©glises √† retables</a>
            <a class="nav-link" href="actualites.html">Actualit√©s</a>
            <a class="nav-link" href="boutique.html">Boutique</a>
            <a class="nav-link click-scroll" href="#section_contact">Contact</a>
        </nav>

        <div class="rf-sidebar-footer">
            <a class="rf-social-link" target="_blank" href="https://www.facebook.com/lesretablesdeflandres">
                <i class="bi bi-facebook"></i>
            </a>
        </div>
    </aside>

    <!-- BOUTON TOGGLE (hamburger 3 barres) -->
    <button id="rfSidebarToggle" class="rf-sidebar-fab" type="button" aria-label="Toggle menu">
        <span></span><span></span><span></span>
    </button>

    <!-- WRAPPER CONTENU -->
    <div id="rfContent" class="rf-content">

        <!-- üì¶ SECTION 1 : HERO HOME (charg√©e dynamiquement) -->
        <div data-load-component="sections/hero-home"></div>

        <!-- üì¶ SECTION 2 : GALERIE CARROUSEL (charg√©e dynamiquement) -->
        <div data-load-component="sections/gallery-carousel"></div>

        <!-- üì¶ SECTION 3 : CTA NEWSLETTER (charg√©e dynamiquement) -->
        <div data-load-component="sections/newsletter-cta"></div>

        <!-- üì¶ SECTION 4 : CONTACT (charg√©e dynamiquement) -->
        <div data-load-component="sections/contact"></div>

        <!-- üì¶ FOOTER (charg√© dynamiquement) -->
        <div id="footerContainer"></div>

    </div><!-- /#rfContent -->

</main>

<!-- JAVASCRIPT FILES -->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/jquery.sticky.js"></script>
<script src="js/click-scroll.js"></script>
<script src="js/custom.js"></script>
<script src="js/sidebar.js"></script>
<script src="js/components-bundle.js"></script>
<script src="js/component-loader.js"></script>
<script src="js/carousel.js"></script>
<script src="js/image-modal.js"></script>

<!-- EmailJS (pour le formulaire de contact) -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<script>
    // ==========================================
    // üéØ INITIALISATION DE LA PAGE
    // ==========================================

    console.log('üöÄ Initialisation de la page d\'accueil...');

    document.addEventListener("DOMContentLoaded", function () {
        console.log('‚úÖ DOM Charg√©');

        // ==========================================
        // üì¶ CHARGEMENT DES COMPOSANTS
        // ==========================================
        setTimeout(function() {
            loadAllComponents();
        }, 100);

        // ==========================================
        // üìß INITIALISATION EMAILJS
        // ==========================================
        setTimeout(function() {
            initEmailJS();
        }, 1000);
    });

    // ==========================================
    // FONCTION : Chargement de tous les composants
    // ==========================================
    async function loadAllComponents() {
        console.log('üì¶ Chargement des composants...');

        try {
            if (!window.COMPONENTS_BUNDLE) {
                console.error('‚ùå Bundle de composants non trouv√©');
                return;
            }

            console.log('‚úÖ Bundle trouv√© avec', Object.keys(window.COMPONENTS_BUNDLE).length, 'composants');

            // Charger le footer
            if (window.loadComponent) {
                await loadComponent('#footerContainer', 'sections/footer');
                console.log('‚úÖ Footer charg√©');
            }

        } catch (error) {
            console.error('‚ùå Erreur lors du chargement des composants:', error);
        }
    }

    // ==========================================
    // FONCTION : Initialisation EmailJS
    // ==========================================
    function initEmailJS() {
        const form = document.getElementById("contact-form");

        if (!form) {
            console.warn('‚ö†Ô∏è Formulaire de contact non trouv√©');
            return;
        }

        console.log('üìß Initialisation EmailJS...');

        emailjs.init("aDQZj6KUMz6fZ2Qs3");

        form.addEventListener("submit", function (event) {
            event.preventDefault();

            const submitBtn = document.getElementById("submit-btn");
            submitBtn.disabled = true;
            submitBtn.innerText = "Envoi en cours...";

            const formData = {
                fullName: document.getElementById("full-name").value,
                phone: document.getElementById("phone").value,
                email: document.getElementById("email").value,
                message: document.getElementById("message").value
            };

            emailjs.send("service_outp9kh", "template_dkbwnu2", formData)
                .then(function () {
                    alert("Message envoy√© avec succ√®s !");
                    form.reset();
                })
                .catch(function (error) {
                    alert("Erreur lors de l'envoi. Veuillez r√©essayer.");
                    console.error("Erreur EmailJS :", error);
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerText = "Envoyer";
                });
        });

        console.log('‚úÖ EmailJS initialis√©');
    }
</script>

</body>

</html>

